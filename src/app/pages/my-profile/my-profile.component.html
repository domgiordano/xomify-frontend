<div class="page-container">
  <app-loader
    [loading]="loading"
    message="Loading your profile..."
  ></app-loader>

  <div class="profile-content" *ngIf="!loading">
    <!-- Profile Header Section -->
    <div class="profile-header">
      <div class="header-banner">
        <div class="banner-gradient"></div>
      </div>

      <div class="header-content">
        <div class="profile-image-wrapper">
          <img
            [src]="profilePicture || 'assets/default-avatar.png'"
            [alt]="userName"
            class="profile-image"
          />
          <div class="image-glow"></div>
          <div class="online-indicator"></div>
        </div>

        <div class="profile-details">
          <h1 class="user-name">{{ userName }}</h1>
          <p class="user-email">{{ email }}</p>

          <div class="profile-stats">
            <div class="stat-item">
              <span class="stat-value">{{ followersCount | number }}</span>
              <span class="stat-label">Followers</span>
            </div>
            <div class="stat-divider"></div>
            <div class="stat-item clickable" routerLink="/my-playlists">
              <span class="stat-value">{{ playlistCount | number }}</span>
              <span class="stat-label">Playlists</span>
            </div>
            <div class="stat-divider"></div>
            <div class="stat-item clickable" routerLink="/following">
              <span class="stat-value">{{ followingCount | number }}</span>
              <span class="stat-label">Following</span>
            </div>
          </div>

          <a [href]="spotifyProfileUrl" target="_blank" class="spotify-btn">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
              <path
                d="M12 0C5.4 0 0 5.4 0 12s5.4 12 12 12 12-5.4 12-12S18.66 0 12 0zm5.521 17.34c-.24.359-.66.48-1.021.24-2.82-1.74-6.36-2.101-10.561-1.141-.418.122-.779-.179-.899-.539-.12-.421.18-.78.54-.9 4.56-1.021 8.52-.6 11.64 1.32.42.18.479.659.301 1.02zm1.44-3.3c-.301.42-.841.6-1.262.3-3.239-1.98-8.159-2.58-11.939-1.38-.479.12-1.02-.12-1.14-.6-.12-.48.12-1.021.6-1.141C9.6 9.9 15 10.561 18.72 12.84c.361.181.54.78.241 1.2zm.12-3.36C15.24 8.4 8.82 8.16 5.16 9.301c-.6.179-1.2-.181-1.38-.721-.18-.601.18-1.2.72-1.381 4.26-1.26 11.28-1.02 15.721 1.621.539.3.719 1.02.419 1.56-.299.421-1.02.599-1.559.3z"
              />
            </svg>
            Open Spotify Profile
          </a>
        </div>
      </div>
    </div>

    <!-- Quick Stats Section -->
    <section class="section quick-stats-section">
      <div class="section-header">
        <h2 class="section-title">Your Listening</h2>
        <span class="section-subtitle">Quick overview of your music taste</span>
      </div>

      <div class="quick-stats-grid">
        <div class="quick-stat-card" routerLink="/top-songs">
          <div class="stat-icon songs">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
              <path
                d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"
              />
            </svg>
          </div>
          <div class="stat-info">
            <span class="stat-title">Top Songs</span>
            <span class="stat-desc">View your most played tracks</span>
          </div>
          <svg
            class="arrow-icon"
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path d="M9 18l6-6-6-6" />
          </svg>
        </div>

        <div class="quick-stat-card" routerLink="/top-artists">
          <div class="stat-icon artists">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
              <path
                d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"
              />
            </svg>
          </div>
          <div class="stat-info">
            <span class="stat-title">Top Artists</span>
            <span class="stat-desc">Discover your favorite artists</span>
          </div>
          <svg
            class="arrow-icon"
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path d="M9 18l6-6-6-6" />
          </svg>
        </div>

        <div class="quick-stat-card" routerLink="/top-genres">
          <div class="stat-icon genres">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
              <path
                d="M4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-1 9h-4v4h-2v-4H9V9h4V5h2v4h4v2z"
              />
            </svg>
          </div>
          <div class="stat-info">
            <span class="stat-title">Top Genres</span>
            <span class="stat-desc">See what styles you love</span>
          </div>
          <svg
            class="arrow-icon"
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path d="M9 18l6-6-6-6" />
          </svg>
        </div>
      </div>
    </section>

    <!-- Enrollment Cards Section -->
    <section class="section enrollment-section">
      <div class="section-header">
        <h2 class="section-title">Features</h2>
        <span class="section-subtitle">Enhance your Xomify experience</span>
      </div>

      <div class="enrollment-grid">
        <!-- Wrapped Card -->
        <div
          class="enrollment-card"
          [class.enrolled]="wrappedEnrolled"
          routerLink="/wrapped"
        >
          <div class="card-icon wrapped">
            <svg width="32" height="32" viewBox="0 0 24 24" fill="currentColor">
              <path
                d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"
              />
            </svg>
          </div>
          <div class="card-content">
            <h3 class="card-title">Monthly Wrapped</h3>
            <p class="card-description">
              Get monthly insights about your listening habits and track your
              music taste over time.
            </p>
            <div class="card-status" *ngIf="wrappedEnrolled">
              <svg
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="currentColor"
              >
                <path
                  d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"
                />
              </svg>
              <span>Enrolled</span>
            </div>
          </div>
          <svg
            class="card-arrow"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path d="M9 18l6-6-6-6" />
          </svg>
        </div>

        <!-- Release Radar Card -->
        <div
          class="enrollment-card"
          [class.enrolled]="releaseRadarEnrolled"
          routerLink="/release-radar"
        >
          <div class="card-icon radar">
            <svg width="32" height="32" viewBox="0 0 24 24" fill="currentColor">
              <path
                d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"
              />
            </svg>
          </div>
          <div class="card-content">
            <h3 class="card-title">Release Radar</h3>
            <p class="card-description">
              Stay updated with new releases from your favorite artists. Never
              miss a drop.
            </p>
            <div class="card-status" *ngIf="releaseRadarEnrolled">
              <svg
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="currentColor"
              >
                <path
                  d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"
                />
              </svg>
              <span>Enrolled</span>
            </div>
          </div>
          <svg
            class="card-arrow"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path d="M9 18l6-6-6-6" />
          </svg>
        </div>
      </div>
    </section>

    <!-- Account Info Section -->
    <section class="section account-section">
      <div class="section-header">
        <h2 class="section-title">Account Details</h2>
        <span class="section-subtitle">Your Spotify account information</span>
      </div>

      <div class="account-card">
        <div class="account-row">
          <span class="account-label">Account Type</span>
          <span class="account-value premium" *ngIf="product === 'premium'">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
              <path
                d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"
              />
            </svg>
            Premium
          </span>
          <span class="account-value free" *ngIf="product !== 'premium'"
            >Free</span
          >
        </div>
        <div class="account-row">
          <span class="account-label">Country</span>
          <span class="account-value">{{ country }}</span>
        </div>
        <div class="account-row">
          <span class="account-label">User ID</span>
          <span class="account-value mono">{{ userId }}</span>
        </div>
      </div>
    </section>
  </div>
</div>

<!-- Rotating Ticker - Fixed at bottom -->
<div class="profile-ticker" *ngIf="tickerLoaded && !loading">
  <div
    class="ticker-label"
    [class.songs]="currentTickerType === 'song'"
    [class.artists]="currentTickerType === 'artist'"
    [class.genres]="currentTickerType === 'genre'"
  >
    <svg
      *ngIf="currentTickerType === 'song'"
      width="16"
      height="16"
      viewBox="0 0 24 24"
      fill="currentColor"
    >
      <path
        d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"
      />
    </svg>
    <svg
      *ngIf="currentTickerType === 'artist'"
      width="16"
      height="16"
      viewBox="0 0 24 24"
      fill="currentColor"
    >
      <path
        d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"
      />
    </svg>
    <svg
      *ngIf="currentTickerType === 'genre'"
      width="16"
      height="16"
      viewBox="0 0 24 24"
      fill="currentColor"
    >
      <path
        d="M4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-1 9h-4v4h-2v-4H9V9h4V5h2v4h4v2z"
      />
    </svg>
    {{ tickerLabel }}
  </div>
  <div class="ticker-wrapper">
    <div class="ticker-track" [class.paused]="tickerPaused">
      <!-- First set -->
      <a
        class="ticker-item"
        *ngFor="let item of tickerItems; let i = index"
        (click)="onTickerItemClick(item)"
        (mouseenter)="tickerPaused = true"
        (mouseleave)="tickerPaused = false"
      >
        <span class="ticker-rank">#{{ i + 1 }}</span>
        <img
          *ngIf="item.image"
          [src]="item.image"
          [alt]="item.name"
          class="ticker-image"
          [class.round]="item.type === 'artist'"
        />
        <div class="ticker-genre-icon" *ngIf="item.type === 'genre'">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
            <path
              d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"
            />
          </svg>
        </div>
        <div class="ticker-text">
          <span class="ticker-name">{{ item.name }}</span>
          <span class="ticker-subtitle" *ngIf="item.subtitle">{{
            item.subtitle
          }}</span>
        </div>
        <span class="ticker-divider">•</span>
      </a>
      <!-- Duplicate for seamless loop -->
      <a
        class="ticker-item"
        *ngFor="let item of tickerItems; let i = index"
        (click)="onTickerItemClick(item)"
        (mouseenter)="tickerPaused = true"
        (mouseleave)="tickerPaused = false"
      >
        <span class="ticker-rank">#{{ i + 1 }}</span>
        <img
          *ngIf="item.image"
          [src]="item.image"
          [alt]="item.name"
          class="ticker-image"
          [class.round]="item.type === 'artist'"
        />
        <div class="ticker-genre-icon" *ngIf="item.type === 'genre'">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
            <path
              d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"
            />
          </svg>
        </div>
        <div class="ticker-text">
          <span class="ticker-name">{{ item.name }}</span>
          <span class="ticker-subtitle" *ngIf="item.subtitle">{{
            item.subtitle
          }}</span>
        </div>
        <span class="ticker-divider">•</span>
      </a>
    </div>
  </div>
</div>
